import { Button } from '@/components/ui/button';
import { Card, CardContent } from '@/components/ui/card';
import Icon from '@/components/ui/icon';
import { Link, useParams, useNavigate } from 'react-router-dom';

interface BlogPost {
  id: number;
  title: string;
  content: string;
  date: string;
  category: string;
  image: string;
  readTime: string;
  author: string;
}

const blogPosts: Record<number, BlogPost> = {
  1: {
    id: 1,
    title: 'Почему официанты не продают: 3 главные ошибки',
    date: '15 октября 2024',
    category: 'Продажи',
    image: 'https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=1200&h=600&fit=crop',
    readTime: '5 мин',
    author: 'Марина',
    content: `
За 10 лет работы в HoReCa я видела сотни ресторанов, где персонал "стараются", но средний чек не растёт. Проблема не в лени или некомпетентности официантов. Проблема в системе.

## Ошибка №1: Скрипты вместо сценариев

**Что происходит:**
Управляющий скачивает из интернета "волшебные фразы", раздаёт их команде и ждёт чуда. Официанты зубрят: "А не желаете ли попробовать наш фирменный десерт?" — и звучит это как робот из call-центра.

**Почему не работает:**
- Гость чувствует фальш
- Официант чувствует себя неловко
- Нет адаптации под разные типы гостей

**Что делать:**
Создавайте живые сценарии, а не мёртвые скрипты. Учите персонал **когда** и **как** предлагать, а не **что говорить дословно**.

### Пример живого сценария:

**Плохо (скрипт):**
"Добрый вечер! Меня зовут Анна, я ваш официант. Могу я предложить вам аперитив?"

**Хорошо (сценарий):**
Официант подходит, оценивает настроение стола. Если гости оживлённо общаются — даёт им 2-3 минуты. Если листают меню в растерянности — сразу помогает:

"Добрый вечер! Вижу, выбор непростой — у нас действительно большое меню. Если хотите, могу подсказать наши хиты или помочь с выбором вина под настроение вечера?"

Видите разницу? Это не заученная фраза — это **помощь**.

## Ошибка №2: Страх "навязаться"

**Что происходит:**
Официант приносит блюдо, ставит его на стол и... исчезает. Боится предложить десерт или вино — "а вдруг подумают, что я навязываюсь?".

**Цифры:**
В заведениях, где персонал не предлагает допродажи, средний чек на **25-40% ниже**, чем мог бы быть.

**Почему не работает:**
Это не забота о госте — это страх. А гость приходит не только поесть, он приходит за **опытом**. И частью этого опыта должна быть помощь в выборе.

**Что делать:**
Меняйте установку с "не навязываться" на "помогать создать идеальный вечер".

### Техника "Мост":

Вместо: "Будете десерт?" (холодно, формально)

Используйте:
"Кстати, после такого сытного стейка идеально зайдёт наш лёгкий лимонный сорбет — он освежает. Или предпочитаете что-то классическое, как тирамису?"

Вы не навязываете — вы **заботитесь**.

## Ошибка №3: Нет обратной связи и поддержки

**Что происходит:**
Официанта один раз обучили, отправили в зал — и всё. Никто не следит за результатами, не даёт фидбэк, не хвалит за успехи.

**Почему не работает:**
- Мотивация падает
- Навыки не развиваются
- Ошибки повторяются

**Что делать:**
Внедрите систему еженедельного фидбэка:

1. **Анализируйте чеки:** кто продаёт лучше, кто проседает
2. **Разбирайте кейсы:** что сработало, что нет
3. **Хвалите публично:** "Катя сегодня продала 8 десертов — давайте разберём, как ей это удалось"
4. **Наставничество:** лучшие помогают новичкам

## Что дальше?

Если вы узнали свою ситуацию хотя бы в одной ошибке — это нормально. Главное, что вы это видите.

**Я помогаю выстроить систему продаж изнутри:**
- Провожу аудит и нахожу слабые точки
- Создаю живые сценарии под ваше заведение
- Обучаю команду в полях (прямо в сменах)
- Внедряю культуру обратной связи

### Результат:
Средний чек растёт на **30% за первые 2 недели**, а команда начинает продавать **без фальши и давления**.

Хотите разобрать вашу ситуацию? Оставьте заявку — обсудим, как вырастить чек в вашем заведении.
    `
  },
  2: {
    id: 2,
    title: 'Как вырастить средний чек на 30% без скриптов',
    date: '8 октября 2024',
    category: 'Кейсы',
    image: 'https://images.unsplash.com/photo-1559329007-40df8a9345d8?w=1200&h=600&fit=crop',
    readTime: '7 мин',
    author: 'Марина',
    content: `
Кейс из практики: как за 14 дней рестораны увеличивает средний чек на 30-35% без скриптов, давления и "впаривания".

## Исходная ситуация

**Формат:** Ресторан премиум-сегмента, 80 посадочных мест
**Проблема:** Средний чек 3200₽ при потенциале 4500₽
**Запрос:** "Персонал старается, но допродаж почти нет"

### Что я обнаружила на аудите:

1. **Официанты боялись предлагать** — "не хотим навязываться"
2. **Не знали меню** — не могли объяснить разницу между винами
3. **Нулевая система мотивации** — делаешь допродажи или нет — без разницы
4. **Управляющий не видел проблему** — "у нас всё хорошо"

## Что сделали за 2 недели

### Неделя 1: Диагностика и погружение

**День 1-2: Тайный гость + анализ чеков**
Я посетила заведение как обычный гость. Результат:
- Официант не предложил ни аперитив, ни десерт
- На вопрос о вине ответил: "Все хорошие, выбирайте"
- Ушла без допродаж на 1900₽ вместо возможных 3500₽

**День 3-4: Разбор полётов с командой**
Собрали всех официантов. Без обвинений, просто спросила:
"Почему не предлагаете?"

Ответы были честные:
- "Боюсь, что откажут"
- "Не знаю, что сказать"
- "У меня и так заказывают"

**День 5-7: Создание живых сценариев**
Вместо скриптов создали **карту касаний** — 7 точек контакта с гостем, где можно естественно помочь:

1. **Приветствие** — считываем настроение
2. **Аперитив** — "начнём вечер правильно?"
3. **Выбор блюд** — помогаем, а не просто принимаем заказ
4. **Вино** — подбираем под блюдо и настроение
5. **Довыносим блюда** — спрашиваем впечатления
6. **Предложение десерта** — через историю или описание
7. **Прощание** — оставляем приятное впечатление

### Неделя 2: Внедрение в полях

**День 8-10: Работаю в сменах**
Я сама встала в зал как официант. Показывала, как работать с гостями.

**Пример живого диалога:**

Гости (пара 35-40 лет) сели за стол. Листают меню, немного растеряны.

**Я:** "Добрый вечер! Вижу, выбор непростой. Подскажу: если хотите лёгкий ужин — наши салаты и рыба невероятные. Если настроение на сытный вечер — стейки и паста. Что ближе?"

**Гость:** "Наверное, стейк. А какой лучше?"

**Я:** "Зависит от настроения. Рибай — сочный, с жирком, для тех, кто любит насыщенный вкус. Филе-миньон — нежнейший, тает во рту, для романтичного вечера. Что по душе?"

**Гость:** "Рибай звучит отлично!"

**Я:** "Идеально! А к нему я бы порекомендовала красное вино — Мальбек из Аргентины. Оно плотное, с нотами чёрной смородины — прямо создано под стейк. Попробуем?"

**Результат:** Вместо стейка за 1800₽ чек вырос до 3900₽ (стейк + вино + гарнир).

**День 11-14: Команда внедряет сама**
Официанты начали повторять. Главное — я была рядом, давала фидбэк после каждой смены:

- "Катя, класс! Как ты предложила десерт через историю — сработало!"
- "Андрей, гость был готов к вину, но ты дал ему слишком много вариантов — он растерялся. В следующий раз сузь выбор до двух."

## Результаты через 14 дней

**Цифры:**
- Средний чек вырос с **3200₽ до 4300₽** (+34%)
- Допродажи десертов выросли на **280%**
- Продажи вина по бокалам — на **150%**
- **NPS (удовлетворённость гостей) вырос с 7.2 до 8.9**

**Отзыв управляющего:**
"Я не верил, что так быстро сработает. Думал, нужны месяцы. А тут — 2 недели, и команда продаёт без давления. Гости довольны, чеки растут."

## Почему сработало?

### 1. Убрали страх
Официанты поняли: предлагать — это не навязывать, а **помогать создать идеальный вечер**.

### 2. Дали инструменты
Не скрипты, а **сценарии**: когда, как, кому предлагать.

### 3. Показали на практике
Я не рассказывала теорию в переговорке — я работала в зале вместе с ними.

### 4. Дали обратную связь
Каждый день разбирали, что сработало, что нет. Хвалили успехи.

## Главные принципы роста чека

**Принцип №1: Продажа = Помощь**
Не "впарить", а помочь гостю получить максимум удовольствия.

**Принцип №2: Сузить выбор**
Не "у нас 15 вин, выбирайте", а "к вашему стейку идеально подойдут два варианта: Мальбек — плотный, насыщенный, или Каберне — классика. Что ближе?"

**Принцип №3: История вместо описания**
Не "у нас есть тирамису", а "наш шеф-кондитер делает тирамису по рецепту своей бабушки из Тосканы — это просто космос. Попробуете?"

**Принцип №4: Обратная связь = Рост**
Официанты не растут сами по себе. Им нужен фидбэк, поддержка, примеры.

## Что дальше?

Этот кейс — не исключение. Это система, которая работает в ресторанах, клубах, отелях.

**Хотите такой же результат?**
- Аудит вашего заведения (тайный гость + анализ чеков)
- Создание живых сценариев под ваше меню
- Внедрение в полях (работаю в ваших сменах)
- Обучение команды + система обратной связи

Средний чек растёт на **30-35% за первые 2 недели**. Проверено на 47 заведениях.

Оставьте заявку — разберём вашу ситуацию и составим план роста.
    `
  },
  3: {
    id: 3,
    title: 'Культура сервиса: что это и как её внедрить',
    date: '1 октября 2024',
    category: 'Сервис',
    image: 'https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=1200&h=600&fit=crop',
    readTime: '6 мин',
    author: 'Марина',
    content: `
"Культура сервиса" — это не про улыбки и "доброе утро". Это про атмосферу, которую гость чувствует кожей. И за которую готов платить больше.

## Что такое культура сервиса на самом деле

Вы когда-нибудь были в месте, где формально всё правильно — официанты вежливые, еда вкусная, интерьер красивый — но что-то **не то**?

А бывали в местах, где даже маленькие косяки не портят впечатление, потому что атмосфера **кайфовая**?

Вот это и есть культура сервиса.

### Культура сервиса — это:

- **Как команда относится к гостям** (искренне или "по скрипту")
- **Как решаются проблемы** (сразу или "это не моя зона")
- **Какая энергетика в зале** (живая или формальная)
- **Насколько персонал вовлечён** (работают для галочки или вкладываются)

## Признаки, что культуры сервиса нет

### ❌ Признак №1: "Это не моя зона"

Гость просит официанта подсказать, где туалет. Ответ: "Не знаю, я тут недавно" или "Спросите у бармена".

**Почему плохо:**
Гостю всё равно, кто новенький, а кто старенький. Ему нужна помощь **сейчас**.

**Как должно быть:**
Официант провожает гостя до туалета или минимум чётко указывает направление. Это **забота**.

### ❌ Признак №2: Формальность вместо искренности

Официант подходит к столу и как робот выдаёт: "Добрый вечер, меня зовут Анна, я ваш официант, могу я принять заказ?"

**Почему плохо:**
Это звучит как call-центр. Гость чувствует, что это "отработка", а не живое общение.

**Как должно быть:**
Официант подходит, считывает настроение стола. Если гости весёлые — поддерживает энергию. Если романтичный ужин — говорит тише, даёт пространство.

### ❌ Признак №3: Нет проактивности

Гость сидит с пустым бокалом 10 минут. Официант проходит мимо — не замечает.

**Почему плохо:**
Гость чувствует себя забытым. А это убивает впечатление даже от отличной еды.

**Как должно быть:**
Официант видит пустой бокал и **сразу** подходит: "Принести ещё воды? Или может, попробуете вино?"

## Как внедрить культуру сервиса: пошаговый план

### Шаг 1: Определите ценности заведения

Спросите себя:
- Какую атмосферу мы создаём? (Уютную? Премиальную? Весёлую?)
- Как мы хотим, чтобы гости себя чувствовали? (Как дома? Как VIP?)
- Что нас отличает от конкурентов?

**Пример:**
Ресторан "Тепло" — уютное место для семейных ужинов.

**Ценности:**
- Искренность (не формальность)
- Забота (как к родным)
- Атмосфера дома

Эти ценности должны пронизывать **всё**: от общения персонала до музыки в зале.

### Шаг 2: Донесите ценности до команды

Недостаточно написать "ценности" на стене. Нужно, чтобы команда их **прожила**.

**Как это сделать:**

**Плохо:** "Мы за искренность. Будьте искренними."

**Хорошо:** "Представьте, что к вам в гости пришёл друг. Как вы его встретите? Улыбнётесь, поможете снять куртку, предложите чай. Вот так же встречайте гостей ресторана — как друзей."

### Шаг 3: Обучите команду "читать" гостей

Культура сервиса — это **гибкость**.

**Пример:**

**Ситуация 1:** Шумная компания друзей — весёлые, громкие.
**Подход официанта:** Поддерживает энергию, шутит, быстро обслуживает, предлагает "компанейские" позиции (закуски, шоты).

**Ситуация 2:** Пара на романтичном ужине — тихие, погружены друг в друга.
**Подход официанта:** Говорит тише, не навязывается, даёт пространство, предлагает вино и десерты деликатно.

**Ситуация 3:** Бизнес-встреча — серьёзные, сосредоточены.
**Подход официанта:** Быстро, чётко, без лишних разговоров. Не отвлекает.

### Шаг 4: Создайте систему обратной связи

Культура сервиса не внедряется за один день. Это процесс.

**Что внедрить:**

1. **Еженедельные планёрки:**
   - Разбираем кейсы: что сработало, что нет
   - Хвалим за успехи
   - Обсуждаем сложные ситуации

2. **Обратная связь от гостей:**
   - QR-код на столе — "Оцените сервис"
   - Анализируем отзывы
   - Хвалим персонал за положительные отзывы

3. **Наставничество:**
   - Лучшие официанты помогают новичкам
   - Делятся опытом

### Шаг 5: Будьте примером

Если управляющий хамит курьеру — команда будет хамить гостям.

Если управляющий приветлив, помогает, заботится — команда впитает это.

**Культура сервиса начинается с вас.**

## Реальный кейс: как культура сервиса увеличила чек

**Заведение:** Клуб премиум-сегмента

**Проблема:**
Гости жаловались: "Красиво, но холодно. Официанты как роботы."

**Что сделали:**

1. **Убрали скрипты** — дали свободу общаться живо
2. **Научили читать гостей** — адаптировать подход под настроение
3. **Внедрили правило "Всё — моя зона"** — любой сотрудник решает проблему гостя
4. **Ввели ритуал "История дня"** — каждую смену делились кейсом, как сделали гостя счастливым

**Результат:**
- NPS вырос с 6.8 до 8.7
- Повторные визиты увеличились на 40%
- Средний чек вырос на 25% (гости стали больше доверять и заказывать)

## Главные принципы культуры сервиса

### 1. Искренность > Формальность
Лучше тёплое "Привет!" без скрипта, чем холодное "Добрый вечер, меня зовут Анна, я ваш официант".

### 2. Проактивность > Реактивность
Не ждите, пока гость попросит — предвосхищайте желания.

### 3. Гибкость > Шаблоны
Каждый гость уникален. Нет универсального подхода.

### 4. Команда > Звёзды
Культура сервиса — это когда **вся** команда вовлечена, а не только "звёздные" официанты.

## Что дальше?

Культура сервиса — это не про один тренинг. Это про **систему**, которая живёт каждый день.

**Я помогаю внедрить культуру сервиса:**
- Определяем ценности вашего заведения
- Обучаем команду "читать" гостей
- Создаём живые сценарии (не скрипты!)
- Внедряем систему обратной связи
- Работаю в ваших сменах — показываю на практике

**Результат:**
Гости возвращаются, рекомендуют, платят больше. А команда работает с удовольствием, а не "для галочки".

Оставьте заявку — обсудим, как внедрить культуру сервиса в вашем заведении.
    `
  }
};

const BlogPost = () => {
  const { id } = useParams<{ id: string }>();
  const navigate = useNavigate();
  const post = id ? blogPosts[parseInt(id)] : null;

  if (!post) {
    return (
      <div className="min-h-screen bg-background flex items-center justify-center">
        <div className="text-center space-y-4">
          <Icon name="FileQuestion" className="mx-auto text-muted-foreground" size={64} />
          <h1 className="text-2xl font-bold text-foreground">Статья не найдена</h1>
          <Button onClick={() => navigate('/blog')}>Вернуться к блогу</Button>
        </div>
      </div>
    );
  }

  const scrollToTop = () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const renderContent = (content: string) => {
    const lines = content.trim().split('\n');
    const elements: JSX.Element[] = [];
    let key = 0;

    lines.forEach((line, index) => {
      line = line.trim();
      
      if (!line) {
        elements.push(<div key={`space-${key++}`} className="h-4" />);
        return;
      }

      if (line.startsWith('## ')) {
        elements.push(
          <h2 key={`h2-${key++}`} className="text-3xl font-black text-foreground mt-12 mb-6">
            {line.substring(3)}
          </h2>
        );
      } else if (line.startsWith('### ')) {
        elements.push(
          <h3 key={`h3-${key++}`} className="text-2xl font-bold text-foreground mt-8 mb-4">
            {line.substring(4)}
          </h3>
        );
      } else if (line.startsWith('**') && line.endsWith('**')) {
        elements.push(
          <p key={`bold-${key++}`} className="text-lg font-bold text-foreground mt-4 mb-2">
            {line.substring(2, line.length - 2)}
          </p>
        );
      } else if (line.startsWith('- ')) {
        elements.push(
          <li key={`li-${key++}`} className="text-lg text-foreground/90 ml-6 mb-2 list-disc">
            {line.substring(2).replace(/\*\*/g, '')}
          </li>
        );
      } else if (line.match(/^\d+\./)) {
        elements.push(
          <li key={`oli-${key++}`} className="text-lg text-foreground/90 ml-6 mb-2 list-decimal">
            {line.substring(line.indexOf('.') + 1).trim().replace(/\*\*/g, '')}
          </li>
        );
      } else {
        const processedLine = line.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        elements.push(
          <p 
            key={`p-${key++}`} 
            className="text-lg text-foreground/90 leading-relaxed mb-4"
            dangerouslySetInnerHTML={{ __html: processedLine }}
          />
        );
      }
    });

    return elements;
  };

  return (
    <div className="min-h-screen bg-background">
      <nav className="fixed top-0 w-full bg-background/95 backdrop-blur-sm z-50 border-b border-border/40">
        <div className="container mx-auto px-6 py-4">
          <div className="flex items-center justify-between">
            <Link to="/" className="text-xl font-bold text-foreground">MARICO PRO</Link>
            <div className="flex items-center gap-6">
              <Link to="/" className="text-sm font-medium hover:text-primary transition-colors">Главная</Link>
              <Link to="/blog" className="text-sm font-medium hover:text-primary transition-colors">Блог</Link>
            </div>
          </div>
        </div>
      </nav>

      <article className="pt-24 pb-16">
        <div className="container mx-auto px-6">
          <div className="max-w-4xl mx-auto">
            <Button 
              variant="ghost" 
              className="mb-8" 
              onClick={() => navigate('/blog')}
            >
              <Icon name="ArrowLeft" className="mr-2" size={16} />
              Вернуться к блогу
            </Button>

            <div className="aspect-[2/1] overflow-hidden rounded-2xl mb-8">
              <img
                src={post.image}
                alt={post.title}
                className="w-full h-full object-cover"
              />
            </div>

            <div className="flex items-center gap-4 mb-6 flex-wrap">
              <span className="px-4 py-2 bg-primary/20 text-primary rounded-full font-medium text-sm">
                {post.category}
              </span>
              <span className="text-muted-foreground text-sm flex items-center gap-2">
                <Icon name="Calendar" size={16} />
                {post.date}
              </span>
              <span className="text-muted-foreground text-sm flex items-center gap-2">
                <Icon name="Clock" size={16} />
                {post.readTime}
              </span>
              <span className="text-muted-foreground text-sm flex items-center gap-2">
                <Icon name="User" size={16} />
                {post.author}
              </span>
            </div>

            <h1 className="text-4xl md:text-5xl font-black text-foreground mb-8 leading-tight">
              {post.title}
            </h1>

            <div className="prose prose-lg max-w-none">
              {renderContent(post.content)}
            </div>

            <Card className="mt-16 border-2 border-primary/40 bg-gradient-to-br from-background to-card">
              <CardContent className="p-8 space-y-6">
                <div className="text-center space-y-4">
                  <h3 className="text-2xl font-black text-foreground">
                    Хотите такой же результат?
                  </h3>
                  <p className="text-foreground/80 text-lg">
                    Оставьте заявку — обсудим вашу ситуацию и составим план роста
                  </p>
                </div>
                <div className="flex flex-col sm:flex-row gap-4 justify-center">
                  <Button size="lg" className="font-semibold" asChild>
                    <Link to="/#contact">
                      Оставить заявку
                    </Link>
                  </Button>
                  <Button size="lg" variant="outline" className="font-semibold border-2" asChild>
                    <a href="https://t.me/marico_pro" target="_blank" rel="noopener noreferrer">
                      <Icon name="Send" className="mr-2" size={20} />
                      Написать в Telegram
                    </a>
                  </Button>
                </div>
              </CardContent>
            </Card>
          </div>
        </div>
      </article>

      <footer className="py-12 bg-secondary text-white">
        <div className="container mx-auto px-6">
          <div className="max-w-4xl mx-auto text-center space-y-6">
            <h3 className="text-3xl font-black">MARICO PRO</h3>
            <p className="text-white/80">Продажи и сервис — одна система.</p>
            <div className="flex justify-center gap-4 flex-wrap">
              <Button variant="ghost" size="icon" className="text-white hover:text-primary" asChild>
                <a href="https://www.instagram.com/marico_pro?igsh=eXljY2RqbHJtdjM4&utm_source=qr" target="_blank" rel="noopener noreferrer">
                  <Icon name="Instagram" size={24} />
                </a>
              </Button>
              <Button variant="ghost" size="icon" className="text-white hover:text-primary" asChild>
                <a href="https://t.me/marico_pro" target="_blank" rel="noopener noreferrer">
                  <Icon name="Send" size={24} />
                </a>
              </Button>
            </div>
            <div className="pt-6 border-t border-white/20 text-white/60 text-sm">
              <p>© 2024 MARICO PRO. Все права защищены.</p>
            </div>
            <button
              onClick={scrollToTop}
              className="mx-auto mt-4 p-3 rounded-full bg-primary hover:bg-primary/80 transition-colors"
              aria-label="Наверх"
            >
              <Icon name="ArrowUp" size={20} />
            </button>
          </div>
        </div>
      </footer>
    </div>
  );
};

export default BlogPost;
